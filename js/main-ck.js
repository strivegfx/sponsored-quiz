/*jshint devel: true*//*global TweenMax: true*//*global Elastic: true*/$(document).ready(function(){var e={s:{mod:$("body").children(".module"),questionWeight:[],userSelection:null,ani:.25,col:{blue:"#00b4ff",blueD:"#005375"},gen:function(){console.log("--> generating settings...")}},g:{getJson:function(){$.getJSON("js/questionnaire-content.json",function(t){console.log("--> got JSON (length = "+t.length+")...");e.s.json=t;e.g.nextFrame(null)}).error(function(){console.log("--> there was an error getting JSON!")})},nextFrame:function(t){console.log("--> initialising...");var n=t!==null?e.g.newRef(t):0,r=e.s.json[n],i=r.containerType,s=e[i].populate.init(r,i,n),o=e.s.mod;console.log("parsing JSON data...");console.log("   -> ref = "+n);console.log("   -> type = "+i);t!==null&&e[i].listeners.off(t);o.html(s);t=o.children(".container-shadow");e.g.transition.panIn(t);e[i].listeners.on(t,i)},state:function(e,t){e.css({display:t})},transition:{panIn:function(t){console.log("--> transition in new content...");TweenMax.set(t,{opacity:"0",transform:"translateX(50px)"});TweenMax.to(t,e.s.ani*3,{opacity:"1",transform:"translateX(0)"})},panOut:function(t){console.log("--> transition out old content...");TweenMax.to(t,e.s.ani*3,{opacity:"0",transform:"translateX(-50px)",onComplete:e.g.nextFrame,onCompleteParams:[t]})}},newRef:function(e,t){console.log("--> getting new json reference number...");t=e.attr("data-ref");t=parseInt(t,10);return t+1},getWeight:function(t,n){var r=n.attr("data-ref"),i=t.attr("data-ref"),s=e.s.json[r].contents[i].weight;e.s.questionWeight.push(s)},navBtn:{mouseenter:function(t){var n=t.children(".icon"),r=e.s.ani;t.attr({"data-state":"over"});TweenMax.to(n,r*3,{left:"-80px",yoyo:!0,repeat:-1})},mouseleave:function(t){var n=t.children(".icon"),r=e.s.ani;t.attr({"data-state":"up"});TweenMax.to(n,r,{left:"-95px"})}},questionFooter:function(t){var n=e.s.json,r=n.length,i=0,s={qVisual:"",qText:""},o,u,a,f;for(o=0;o<r;o++){u=n[o].containerType;(u==="questionText"||u==="questionImage")&&i++;o===t&&(a=i)}f=650/i;for(o=0;o<i;o++){s.qVisual+='<li data-ref="'+o+'" ';o+1===a&&(s.qVisual+='class="active"');s.qVisual+='style="width:'+f+'px;"></li><!---->'}s.qText="Question "+a+" of "+i;return s},userSelection:function(t){e.s.userSelection=t.children(".main-content").attr("data-profile");console.log("--> user selection = "+e.s.userSelection)}},welcome:{populate:{init:function(e,t,n){return'<div class="container-shadow" data-ref="'+n+'" data-type="'+t+'">'+'<h2 class="main-heading">'+e.heading+"</h2>"+'<div class="main-content">'+'<div class="intro">'+e.contents+"</div>"+'<div class="btn nav continue">'+'<div class="icon"></div>'+"Continue"+"</div>"+"</div>"+'<div class="footer"></div>'+"</div>"}},listeners:{on:function(t){t.find(".continue").on("mouseenter.disposable",function(){e.g.navBtn.mouseenter($(this))}).on("mouseleave.disposable",function(){e.g.navBtn.mouseleave($(this))}).on("click.disposable",function(){e.g.transition.panOut(t)})},off:function(e){e.find(".continue").off(".disposable")}},actions:{}},questionText:{populate:{init:function(t,n,r){var i=e.g.questionFooter(r);return'<div class="container-shadow" data-ref="'+r+'" data-type="'+n+'">'+'<h2 class="main-heading">'+'<div class="icon"></div>'+t.heading+"</h2>"+e.questionText.populate.questions(t)+'<div class="footer progress">'+'<ul class="visual">'+i.qVisual+"</ul>"+'<p class="text h4">'+i.qText+"</p>"+"</div>"+"</div>"},questions:function(e){var t=e.contents.length,n='<ul class="main-content" data-length="'+t+'">',r;for(r=0;r<t;r++)n+='<li class="btn answer" data-ref="'+r+'" data-state="up">'+'<div class="icon"></div>'+e.contents[r].answer+"</li><!---->";return n+="</ul>"}},listeners:{on:function(t,n){t.children(".main-content").on("mouseenter.disposable",".answer",function(){e[n].actions.answer.mouseenter($(this))}).on("mouseleave.disposable",".answer",function(){e[n].actions.answer.mouseleave($(this))}).on("click.disposable",".answer",function(){e[n].actions.answer.onclick($(this),t)})},off:function(e){e.children(".main-content").children(".answer").off(".disposable")}},actions:{answer:{mouseenter:function(t){var n=t.children(".icon"),r=e.s.ani;t.attr({"data-state":"over"});TweenMax.set(n,{display:"block"});TweenMax.to(n,r,{opacity:"1"});TweenMax.to(n,r*3,{left:"-90px",yoyo:!0,repeat:-1})},mouseleave:function(t){var n=t.children(".icon"),r=e.s.ani;t.attr({"data-state":"up"});TweenMax.to(n,r,{left:"-115px",opacity:"0",onComplete:e.g.state,onCompleteParams:[n,"none"]})},onclick:function(t,n){t.attr({"data-state":"active"});e.g.getWeight(t,n);e.g.transition.panOut(n)}}}},questionImage:{populate:{init:function(t,n,r){var i=e.g.questionFooter(r);return'<div class="container-shadow" data-ref="'+r+'" data-type="'+n+'">'+'<h2 class="main-heading">'+'<div class="icon"></div>'+t.heading+"</h2>"+e.questionImage.populate.questions(t,r)+'<div class="footer progress">'+'<ul class="visual">'+i.qVisual+"</ul>"+'<p class="text h4">'+i.qText+"</p>"+"</div>"+"</div>"},questions:function(e,t){var n=e.contents.length,r='<ul class="main-content" data-length="'+n+'">',i;for(i=0;i<n;i++)r+='<li class="btn answer" data-ref="2" data-state="up" style="background-image: url(img/module-'+t+"-answer-"+i+'.jpg);">'+'<div class="icon"></div>'+"</li><!---->";return r+="</ul>"}},listeners:{on:function(t,n){t.children(".main-content").on("mouseenter.disposable",".answer",function(){e[n].actions.answer.mouseenter($(this))}).on("mouseleave.disposable",".answer",function(){e[n].actions.answer.mouseleave($(this))}).on("click.disposable",".answer",function(){e[n].actions.answer.onclick($(this),t)})},off:function(e){e.children(".main-content").children(".answer").off(".disposable")}},actions:{answer:{mouseenter:function(t){var n=t.children(".icon"),r=t.siblings().not(t),i=e.s.ani;t.attr({"data-state":"over"});TweenMax.set(t,{opacity:"1"});TweenMax.set(n,{display:"block"});TweenMax.to(n,i,{opacity:"1"});TweenMax.to(n,i*3,{left:"-70px",top:"-70px",yoyo:!0,repeat:-1});TweenMax.to(r,i,{opacity:"0.5"})},mouseleave:function(t){var n=t.children(".icon"),r=t.siblings(),i=e.s.ani;t.attr({"data-state":"up"});TweenMax.to(n,i,{left:"-90px",opacity:"0",top:"-90px",onComplete:e.g.state,onCompleteParams:[n,"none"]});TweenMax.to(r,i,{opacity:"1"})},onclick:function(t,n){t.attr({"data-state":"active"});e.g.getWeight(t,n);e.g.transition.panOut(n)}}}},results:{populate:{init:function(t,n,r){var i=e[n].populate.results();return'<div class="container-shadow" data-ref="'+r+'" data-type="'+n+'">'+'<h2 class="main-heading">'+t.heading+" "+t.profiles[i.winner].kind+"</h2>"+'<div class="main-content" data-profile="'+i.winner+'">'+'<img class="winner-image" src="img/profile-badge-'+i.winner+'.png">'+'<div class="intro">'+'<span class="blurb">'+t.profiles[i.winner].blurb+"</span>"+'<div class="btn nav continue">'+'<div class="icon"></div>'+"Continue"+"</div>"+"</div>"+"</div>"+'<div class="footer">'+"<h3>"+t.userPrompt+"</h3>"+e[n].populate.extraProfile(t,i)+"</div>"+"</div>"},results:function(){var t=e.s.questionWeight,n=t.length,r=t[0].length,i=[],s={winner:0,loser:[]},o,u;for(u=0;u<r;u++)i.push(0);for(o=0;o<n;o++)for(u=0;u<r;u++)i[u]+=t[o][u];for(u=0;u<r;u++){console.log("is "+i[u]+" > "+s.winner);i[u]>i[s.winner]&&(s.winner=u)}for(u=0;u<r;u++)u!==s.winner&&s.loser.push(u);return s},extraProfile:function(e,t){var n=t.loser.length,r='<ul class="extra-profile-container" data-length="'+n+'">',i;for(i=0;i<n;i++)r+='<li class="profile-image btn" data-profile="'+t.loser[i]+'">'+'<div class="icon" style="background-position: '+t.loser[i]*-100+'px -410px"></div>'+'<img src="img/profile-badge-'+t.loser[i]+'.png">'+"</li><!---->";return r+="</ul>"}},listeners:{on:function(t,n){t.children(".footer").find(".extra-profile-container").on("mouseenter.disposable",".profile-image",function(){e[n].actions.badge.mouseenter($(this))}).on("mouseleave.disposable",".profile-image",function(){e[n].actions.badge.mouseleave($(this))}).on("click.disposable",".profile-image",function(){e[n].actions.badge.onclick.init($(this),t,n)});t.find(".continue").on("mouseenter.disposable",function(){e.g.navBtn.mouseenter($(this))}).on("mouseleave.disposable",function(){e.g.navBtn.mouseleave($(this))}).on("click.disposable",function(){e.g.transition.panOut(t);e.g.userSelection(t)})},off:function(e){e.children(".footer").find(".extra-profile-container").off(".disposable");e.find(".continue").off(".disposable")}},actions:{badge:{mouseenter:function(t){var n=t.children(".icon"),r=t.siblings().not(t),i=e.s.ani;t.attr({"data-state":"over"});TweenMax.set(t,{opacity:"1"});TweenMax.set(n,{display:"block"});TweenMax.to(n,i,{opacity:"1"});TweenMax.to(n,i*3,{left:"-45px",top:"-45px",yoyo:!0,repeat:-1});TweenMax.to(r,i,{opacity:"0.5"})},mouseleave:function(t){var n=t.children(".icon"),r=t.siblings(),i=e.s.ani;t.attr({"data-state":"up"});TweenMax.to(n,i,{left:"-65px",opacity:"0",top:"-65px",onComplete:e.g.state,onCompleteParams:[n,"none"]});TweenMax.to(r,i,{opacity:"1"})},onclick:{init:function(t,n,r){console.log("$t = "+r);var i=n.attr("data-ref"),s=n.find(".main-content"),o=s.attr("data-profile"),u=t.attr("data-profile"),a=e.s.json[i];n.find(".main-heading").text(a.heading+" "+a.profiles[u].kind);s.attr({"data-profile":u});e[r].actions.badge.onclick.scaleOut(s.find(".winner-image"),u,"winner",r);s.find(".blurb").text(a.profiles[u].blurb);t.attr({"data-profile":o});e[r].actions.badge.onclick.scaleOut(t,o,"loser",r)},winnerScaleIn:function(t,n){t.attr({src:"img/profile-badge-"+n+".png"});TweenMax.set(t,{transform:"scale(0.75)"});TweenMax.to(t,e.s.ani,{opacity:"1",transform:"scale(1)"})},loserScaleIn:function(t,n){t.find("img").attr({src:"img/profile-badge-"+n+".png"});t.find(".icon").css({"background-position":n*-100+"px -410px"});TweenMax.set(t,{transform:"scale(1.25)"});TweenMax.to(t,e.s.ani,{opacity:"1",transform:"scale(1)"})},scaleOut:function(t,n,r,i){console.log("$kind = "+r);var s=r==="winner"?1.15:.75;TweenMax.to(t,e.s.ani,{opacity:"0",transform:"scale("+s+")",onComplete:e[i].actions.badge.onclick[r+"ScaleIn"],onCompleteParams:[t,n]})}}}}},userForm:{populate:{init:function(e,t,n){return'<div class="container-shadow" data-ref="'+n+'" data-type="'+t+'">'+'<h2 class="main-heading">'+"Enter your details below to be in to win a $10,000 Australian experience"+'<div class="icon"></div>'+"</h2>"+'<div class="main-content">'+'<div class="btn nav prize">'+'<div class="icon"></div>'+"View your prize"+"</div>"+"<hr>"+"<form>"+'<ul class="text-elements">'+'<li class="text padding" data-state="up" data-validate="true">'+'<label for="userName">Name</label>'+'<input id="userName" class="validate" type="text" name="userName" placeholder="First Last" required>'+"</li><!--"+'--><li class="text" data-state="up" data-validate="true">'+'<label for="userPhone">Daytime phone number</label>'+'<input id="userPhone" class="validate" type="tel" name="userPhone" placeholder="88-888-8888" required>'+"</li><!--"+'--><li class="text padding" data-state="up" data-validate="true">'+'<label for="userEmail">Email</label>'+'<input id="userEmail" class="validate" type="email" name="userEmail" placeholder="youremail@gmail.com" required>'+"</li><!--"+'--><li class="text" data-state="up">'+'<label for="userSST">Sunday Star Times Promo Code</label>'+'<input id="userSST" type="tel" name="userSST" placeholder="8888">'+"</li>"+"</ul>"+"<hr>"+"I would like to receive additional information from..."+'<ul class="check-elements">'+'<li class="check padding">'+'<input id="tourismAustralia" type="checkbox" name="tourismAustralia">'+'<label for="tourismAustralia">Tourism Australia</label>'+"</li><!--"+'--><li class="check padding">'+'<input id="untitedTravel" type="checkbox" name="untitedTravel">'+'<label for="untitedTravel">United Travel</label>'+"</li><!--"+'--><li class="check padding">'+'<input id="fairfaxMedia" type="checkbox" name="fairfaxMedia">'+'<label for="fairfaxMedia">Fairfax Media</label>'+"</li><!--"+'--><li class="check">'+'<input id="qantas" type="checkbox" name="qantas">'+'<label for="qantas">Qantas Red E-mail</label>'+"</li>"+"</ul>"+"<hr>"+'<ul class="condition-elements">'+'<li class="check" data-validate="true">'+'<input id="conditions" class="validate" type="checkbox" name="conditions" required>'+'<label for="conditions">I accept the Terms &#38; Conditions</label>'+"</li>"+"</ul>"+'<ul class="button-container">'+'<li class="btn nav submit">'+'<div class="icon"></div>'+'<input class="btn" type="submit" value="Submit">'+"</li>"+'<li class="btn nav skip">'+'<div class="icon"></div>'+"Skip"+"</li>"+"</ul>"+"</form>"+"</div>"+'<div class="footer"></div>'+"</div>"}},listeners:{on:function(t,n){var r=t.children(".main-content").children("form"),i=r.children(".text-elements");i.find("input").on("mouseenter.disposable",function(){e[n].actions.inputField.mouseenter($(this))}).on("mouseleave.disposable",function(){e[n].actions.inputField.mouseleave($(this))}).on("focus.disposable",function(){e[n].actions.inputField.onfocus($(this))}).on("blur.disposable",function(){e[n].actions.inputField.onblur(n,$(this))});r.children(".button-container").on("mouseenter.disposable",".btn.nav",function(){var t=$(this);t.hasClass("submit")&&e.g.navBtn.mouseenter($(this));t.hasClass("skip")&&e[n].actions.navBtn.skip.mouseenter(t)}).on("mouseleave.disposable",".btn.nav",function(){var t=$(this);t.hasClass("submit")&&e.g.navBtn.mouseleave($(this));t.hasClass("skip")&&e[n].actions.navBtn.skip.mouseleave(t)}).on("click.disposable",".btn.nav",function(){var i=$(this);i.hasClass("submit")&&e[n].actions.navBtn.submit.onclick(n,r);i.hasClass("skip")&&e.g.transition.panOut(t)})},off:function(e){var t=e.children(".main-content").children("form");t.children(".text-elements").find("input").off(".disposable");t.children(".button-container").children(".btn.nav").off(".disposable")}},actions:{validate:{checkPattern:function(e,t,n){console.log("--> checking pattern...");if(n.test(t)){console.log("   ... pattern = match");e.parent().attr({"data-validate":"true"});return"true"}console.log("   ... pattern = miss-match");e.parent().attr({"data-validate":"false"});return"false"},text:function(t,n){var r=n.val(),i=/[a-z ]/gi;console.log("current text val = "+r);return e[t].actions.validate.checkPattern(n,r,i)},tel:function(t,n){var r=n.val(),i=/[0-9- ]/gi;console.log("current tel val = "+r);return e[t].actions.validate.checkPattern(n,r,i)},email:function(t,n){var r=n.val(),i=/[a-zA-Z0-9-]{1,}@([a-zA-Z\.])?[a-zA-Z]{1,}\.[a-zA-Z]{1,4}/gi;console.log("current email val = "+r);return e[t].actions.validate.checkPattern(n,r,i)},checkbox:function(e,t){var n=t.prop("checked");console.log("checking conditions...");if(n){console.log("   ... checked");t.parent().attr({"data-validate":"true"});return"true"}console.log("   ... not checked");t.parent().attr({"data-validate":"false"});return"false"}},inputField:{mouseenter:function(e){var t=e.parent(),n=e.val(),r=t.attr("data-state");n===""&&r!=="focus"&&t.attr({"data-state":"over"})},mouseleave:function(e){var t=e.parent(),n=e.val(),r=t.attr("data-state");n===""&&r!=="focus"&&t.attr({"data-state":"up"})},onfocus:function(e){var t=e.parent();t.attr({"data-state":"focus"})},onblur:function(t,n){var r=n.parent(),i=n.val(),s="true",o;if(n.hasClass("validate")){o=n.attr("type");s=e[t].actions.validate[o](t,n)}(i===""||s==="false")&&r.attr({"data-state":"up"})}},navBtn:{submit:{onclick:function(t,n){var r="true",i,s;n.find("input.validate").each(function(){i=$(this);s=i.attr("type");e[t].actions.validate[s](t,i)==="false"&&(r="false")});console.log("validate submission = "+r)}},skip:{mouseenter:function(e){},mouseleave:function(e){}}}}},other:{init:function(){},listeners:{on:function(){},off:function(){}},actions:{}},socialMedia:{populate:{init:function(t,n,r){var i=e.g.questionFooter(r);return'<div class="container-shadow" data-ref="'+r+'" data-type="'+n+'">'+'<h2 class="main-heading">'+'<div class="icon"></div>'+t.heading+"</h2>"+e.questionImage.populate.questions(t,r)+'<div class="footer progress">'+'<ul class="visual">'+i.qVisual+"</ul>"+'<p class="text h4">'+i.qText+"</p>"+"</div>"+"</div>"}},listeners:{on:function(e,t){},off:function(e){}},actions:{continueBtn:{onclick:function(){console.log("---> offer up specific content to user...")}},socialBtn:{mouseenter:function(t){var n=t.children(".icon"),r=t.siblings().not(t),i=e.s.ani;t.attr({"data-state":"over"});TweenMax.set(t,{opacity:"1"});TweenMax.set(n,{display:"block"});TweenMax.to(n,i,{opacity:"1"});TweenMax.to(n,i*3,{left:"-70px",top:"-70px",yoyo:!0,repeat:-1});TweenMax.to(r,i,{opacity:"0.5"})},mouseleave:function(t){var n=t.children(".icon"),r=t.siblings(),i=e.s.ani;t.attr({"data-state":"up"});TweenMax.to(n,i,{left:"-90px",opacity:"0",top:"-90px",onComplete:e.g.state,onCompleteParams:[n,"none"]});TweenMax.to(r,i,{opacity:"1"})},onclick:function(t,n){t.attr({"data-state":"active"});e.g.getWeight(t,n);e.g.transition.panOut(n)}}}}};(function(){e.g.getJson()})()});