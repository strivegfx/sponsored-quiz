/*jshint devel: true*//*global TweenMax: true*//*global Elastic: true*/$(document).ready(function(){var e={s:{mod:$("body").children(".module"),questionWeight:[],badgeSelection:null,ani:.25,col:{blue:"#00b4ff",blueD:"#005375"},gen:function(){console.log("--> generating settings...")}},g:{getJson:function(){$.getJSON("js/questionnaire-content.json",function(t){console.log("--> got JSON (length = "+t.length+")...");e.s.json=t;e.g.nextFrame(null)}).error(function(){console.log("--> there was an error getting JSON!")})},nextFrame:function(t){console.log("--> initialising...");var n=t!==null?e.g.newRef(t):0,r=e.s.json[n],i=r.containerType,s=e[i].populate.init(r,i,n),o=e.s.mod;console.log("parsing JSON data...");console.log("   -> ref = "+n);console.log("   -> type = "+i);t!==null&&e[i].listeners.off(t);o.html(s);t=o.children(".container-shadow");e.g.transition.panIn(t);e[i].listeners.on(t,i,r)},state:function(e,t){e.css({display:t})},transition:{panIn:function(t){console.log("--> transition in new content...");TweenMax.set(t,{opacity:"0",transform:"translateX(50px)"});TweenMax.to(t,e.s.ani*3,{opacity:"1",transform:"translateX(0)"})},panOut:function(t){console.log("--> transition out old content...");TweenMax.to(t,e.s.ani*3,{opacity:"0",transform:"translateX(-50px)",onComplete:e.g.nextFrame,onCompleteParams:[t]})}},newRef:function(e,t){console.log("--> getting new json reference number...");t=e.attr("data-ref");t=parseInt(t,10);return t+1},getWeight:function(t,n){var r=n.attr("data-ref"),i=t.attr("data-ref"),s=e.s.json[r].contents[i].weight;e.s.questionWeight.push(s)},navBtn:{mouseenter:function(t){var n=t.children(".icon"),r=e.s.ani;t.attr({"data-state":"over"});TweenMax.to(n,r*3,{left:"-80px",yoyo:!0,repeat:-1})},mouseleave:function(t){var n=t.children(".icon"),r=e.s.ani;t.attr({"data-state":"up"});TweenMax.to(n,r,{left:"-95px"})}},questionFooter:function(t){var n=e.s.json,r=n.length,i=0,s={qVisual:"",qText:""},o,u,a,f;for(o=0;o<r;o++){u=n[o].containerType;(u==="questionText"||u==="questionImage")&&i++;o===t&&(a=i)}f=600/i;for(o=0;o<i;o++){s.qVisual+='<li data-ref="'+o+'" ';o+1===a&&(s.qVisual+='class="active"');s.qVisual+='style="width:'+f+'px;"></li><!---->'}s.qText="Question "+a+" of "+i;return s}},welcome:{populate:{init:function(e,t,n){return'<div class="container-shadow" data-ref="'+n+'" data-type="'+t+'">'+'<h2 class="main-heading">What kind of traveller are you?</h2>'+'<div class="main-content">'+'<div class="intro">'+"<p>For the best experiences in Australia, we have created travel styles to suit who you are. You might be a Nature Seeker? Eco Indulger? Food Fanatic? Active Adventurer? Or maybe a Coastal Cruiser? Our fun quiz will help you find what kind of traveller you are and reveal the best Australian experiences to you.</p>"+"<p>Take the quiz now to be in to win a $10,000 experience flying Qantas</p>"+"<p>Check out this weeks Sunday Star Times for a promo code that gets you an additional entry into the competition!</p>"+"</div>"+'<div class="btn nav continue">'+'<div class="icon"></div>'+"Continue"+"</div>"+"</div>"+'<div class="footer"></div>'+"</div>"}},listeners:{on:function(t){t.find(".continue").on("mouseenter.disposable",function(){e.g.navBtn.mouseenter($(this))}).on("mouseleave.disposable",function(){e.g.navBtn.mouseleave($(this))}).on("click.disposable",function(){e.g.transition.panOut(t)})},off:function(e){e.find(".continue").off(".disposable")}},actions:{}},questionText:{populate:{init:function(t,n,r){var i=e.g.questionFooter(r);return'<div class="container-shadow" data-ref="'+r+'" data-type="'+n+'">'+'<h2 class="main-heading">'+'<div class="icon"></div>'+t.heading+"</h2>"+e.questionText.populate.questions(t)+'<div class="footer progress">'+'<ul class="visual">'+i.qVisual+"</ul>"+'<p class="text h4">'+i.qText+"</p>"+"</div>"+"</div>"},questions:function(e){var t=e.contents.length,n='<ul class="main-content" data-length="'+t+'">',r;for(r=0;r<t;r++)n+='<li class="btn answer" data-ref="'+r+'" data-state="up">'+'<div class="icon"></div>'+e.contents[r].answer+"</li><!---->";return n+="</ul>"}},listeners:{on:function(t,n){t.children(".main-content").on("mouseenter.disposable",".answer",function(){e[n].actions.answer.mouseenter($(this))}).on("mouseleave.disposable",".answer",function(){e[n].actions.answer.mouseleave($(this))}).on("click.disposable",".answer",function(){e[n].actions.answer.onclick($(this),t)})},off:function(e){e.children(".main-content").children(".answer").off(".disposable")}},actions:{answer:{mouseenter:function(t){var n=t.children(".icon"),r=e.s.ani;t.attr({"data-state":"over"});TweenMax.set(n,{display:"block"});TweenMax.to(n,r,{opacity:"1"});TweenMax.to(n,r*3,{left:"-90px",yoyo:!0,repeat:-1})},mouseleave:function(t){var n=t.children(".icon"),r=e.s.ani;t.attr({"data-state":"up"});TweenMax.to(n,r,{left:"-115px",opacity:"0",onComplete:e.g.state,onCompleteParams:[n,"none"]})},onclick:function(t,n){t.attr({"data-state":"active"});e.g.getWeight(t,n);e.g.transition.panOut(n)}}}},questionImage:{populate:{init:function(t,n,r){var i=e.g.questionFooter(r);return'<div class="container-shadow" data-ref="'+r+'" data-type="'+n+'">'+'<h2 class="main-heading">'+'<div class="icon"></div>'+t.heading+"</h2>"+e.questionImage.populate.questions(t,r)+'<div class="footer progress">'+'<ul class="visual">'+i.qVisual+"</ul>"+'<p class="text h4">'+i.qText+"</p>"+"</div>"+"</div>"},questions:function(e,t){var n=e.contents.length,r='<ul class="main-content" data-length="'+n+'">',i;for(i=0;i<n;i++)r+='<li class="btn answer" data-ref="2" data-state="up" style="background-image: url(img/module-'+t+"-answer-"+i+'.jpg);">'+'<div class="icon"></div>'+"</li><!---->";return r+="</ul>"}},listeners:{on:function(t,n){t.children(".main-content").on("mouseenter.disposable",".answer",function(){e[n].actions.answer.mouseenter($(this))}).on("mouseleave.disposable",".answer",function(){e[n].actions.answer.mouseleave($(this))}).on("click.disposable",".answer",function(){e[n].actions.answer.onclick($(this),t)})},off:function(e){e.children(".main-content").children(".answer").off(".disposable")}},actions:{answer:{mouseenter:function(t){var n=t.children(".icon"),r=t.siblings().not(t),i=e.s.ani;t.attr({"data-state":"over"});TweenMax.set(t,{opacity:"1"});TweenMax.set(n,{display:"block"});TweenMax.to(n,i,{opacity:"1"});TweenMax.to(n,i*3,{left:"-70px",top:"-70px",yoyo:!0,repeat:-1});TweenMax.to(r,i,{opacity:"0.5"})},mouseleave:function(t){var n=t.children(".icon"),r=t.siblings(),i=e.s.ani;t.attr({"data-state":"up"});TweenMax.to(n,i,{left:"-90px",opacity:"0",top:"-90px",onComplete:e.g.state,onCompleteParams:[n,"none"]});TweenMax.to(r,i,{opacity:"1"})},onclick:function(t,n){t.attr({"data-state":"active"});e.g.getWeight(t,n);e.g.transition.panOut(n)}}}},results:{populate:{init:function(t,n,r){var i=e[n].populate.results();return'<div class="container-shadow" data-ref="'+r+'" data-type="'+n+'">'+'<h2 class="main-heading">Congratulations you are '+t.profiles[i.winner].indefiniteArticle+" "+t.profiles[i.winner].kind+"</h2>"+'<div class="main-content" data-profile="'+i.winner+'">'+'<img class="winner-image" src="img/profile-badge-'+i.winner+'.png">'+'<div class="intro">'+'<span class="blurb">'+t.profiles[i.winner].blurb+"</span>"+'<div class="btn nav continue">'+'<div class="icon"></div>'+"Continue"+"</div>"+"</div>"+"</div>"+'<div class="footer">'+"<h3>"+"<p>Not quite the traveller profile you thought you'd be?</p>"+"<p>Are you one of the following?</p>"+"</h3>"+e[n].populate.extraProfile(t,i)+"</div>"+"</div>"},results:function(){var t=e.s.questionWeight,n=t.length,r=t[0].length,i=[],s={winner:0,loser:[]},o,u;for(u=0;u<r;u++)i.push(0);for(o=0;o<n;o++)for(u=0;u<r;u++)i[u]+=t[o][u];for(u=0;u<r;u++){console.log("is "+i[u]+" > "+s.winner);i[u]>i[s.winner]&&(s.winner=u)}for(u=0;u<r;u++)u!==s.winner&&s.loser.push(u);return s},extraProfile:function(e,t){var n=t.loser.length,r='<ul class="extra-profile-container" data-length="'+n+'">',i;for(i=0;i<n;i++)r+='<li class="profile-image btn" data-profile="'+t.loser[i]+'">'+'<div class="icon" style="background-position: '+t.loser[i]*-100+'px -410px"></div>'+'<img src="img/profile-badge-'+t.loser[i]+'.png">'+"</li><!---->";return r+="</ul>"}},listeners:{on:function(t,n,r){t.children(".footer").find(".extra-profile-container").on("mouseenter.disposable",".profile-image",function(){e[n].actions.badge.mouseenter($(this))}).on("mouseleave.disposable",".profile-image",function(){e[n].actions.badge.mouseleave($(this))}).on("click.disposable",".profile-image",function(){e[n].actions.badge.onclick.init($(this),t,n,r)});t.find(".continue").on("mouseenter.disposable",function(){e.g.navBtn.mouseenter($(this))}).on("mouseleave.disposable",function(){e.g.navBtn.mouseleave($(this))}).on("click.disposable",function(){e.g.transition.panOut(t);e[n].actions.badge.badgeSelection(t,r)})},off:function(e){e.children(".footer").find(".extra-profile-container").off(".disposable");e.find(".continue").off(".disposable")}},actions:{badge:{mouseenter:function(t){var n=t.children(".icon"),r=t.siblings().not(t),i=e.s.ani;t.attr({"data-state":"over"});TweenMax.set(t,{opacity:"1"});TweenMax.set(n,{display:"block"});TweenMax.to(n,i,{opacity:"1"});TweenMax.to(n,i*3,{left:"-45px",top:"-45px",yoyo:!0,repeat:-1});TweenMax.to(r,i,{opacity:"0.5"})},mouseleave:function(t){var n=t.children(".icon"),r=t.siblings(),i=e.s.ani;t.attr({"data-state":"up"});TweenMax.to(n,i,{left:"-65px",opacity:"0",top:"-65px",onComplete:e.g.state,onCompleteParams:[n,"none"]});TweenMax.to(r,i,{opacity:"1"})},onclick:{init:function(t,n,r,i){console.log("$t = "+r);var s=n.find(".main-content"),o=s.attr("data-profile"),u=t.attr("data-profile");n.find(".main-heading").text("Congratulations you are "+i.profiles[u].indefiniteArticle+" "+i.profiles[u].kind);s.attr({"data-profile":u});e[r].actions.badge.onclick.scaleOut(s.find(".winner-image"),u,"winner",r);s.find(".blurb").text(i.profiles[u].blurb);t.attr({"data-profile":o});e[r].actions.badge.onclick.scaleOut(t,o,"loser",r)},winnerScaleIn:function(t,n){t.attr({src:"img/profile-badge-"+n+".png"});TweenMax.set(t,{transform:"scale(0.75)"});TweenMax.to(t,e.s.ani,{opacity:"1",transform:"scale(1)"})},loserScaleIn:function(t,n){t.find("img").attr({src:"img/profile-badge-"+n+".png"});t.find(".icon").css({"background-position":n*-100+"px -410px"});TweenMax.set(t,{transform:"scale(1.25)"});TweenMax.to(t,e.s.ani,{opacity:"1",transform:"scale(1)"})},scaleOut:function(t,n,r,i){console.log("$kind = "+r);var s=r==="winner"?1.15:.75;TweenMax.to(t,e.s.ani,{opacity:"0",transform:"scale("+s+")",onComplete:e[i].actions.badge.onclick[r+"ScaleIn"],onCompleteParams:[t,n]})}},badgeSelection:function(t,n){var r=t.children(".main-content").attr("data-profile");e.s.badgeSelection=n.profiles[r]}}}},userForm:{populate:{init:function(e,t,n){return'<div class="container-shadow" data-ref="'+n+'" data-type="'+t+'">'+'<h2 class="main-heading">'+"Competition Form"+'<div class="icon"></div>'+"</h2>"+'<div class="main-content">'+'<h3 class="intro">Enter your details below to be in to win a $10,000 Australian experience.</h3>'+'<a class="btn nav prize" href="www.stuff.co.nz/prize" target="_blank">'+'<div class="icon"></div>'+"View your prize"+"</a>"+"<hr>"+"<form>"+'<ul class="string-elements">'+'<li class="padding">'+'<input id="userName" type="text" name="userName" placeholder="First Last" required>'+'<label for="userName">Name</label>'+"</li><!--"+"--><li>"+'<input id="userPhone" type="tel" name="userPhone" placeholder="88-888-8888" required>'+'<label for="userPhone">Daytime phone number</label>'+"</li><!--"+'--><li class="padding">'+'<input id="userEmail" type="email" name="userEmail" placeholder="youremail@gmail.com" required>'+'<label for="userEmail">Email</label>'+"</li><!--"+"--><li>"+'<input id="userCode" type="text" name="userCode" placeholder="8888">'+'<label for="userCode">Sunday Star Times Promo Code</label>'+"</li>"+"</ul>"+"<hr>"+"I would like to receive additional information from..."+'<ul class="check-elements">'+'<li class="padding">'+'<input id="tourismAustralia" type="checkbox" name="moreInfo[]" value="tourismAustralia">'+'<label for="tourismAustralia">Tourism Australia</label>'+"</li><!--"+'--><li class="padding">'+'<input id="untitedTravel" type="checkbox" name="moreInfo[]" value="untitedTravel">'+'<label for="untitedTravel">United Travel</label>'+"</li><!--"+'--><li class="padding">'+'<input id="fairfaxMedia" type="checkbox" name="moreInfo[]" value="fairfaxMedia">'+'<label for="fairfaxMedia">Fairfax Media</label>'+"</li><!--"+"--><li>"+'<input id="qantas" type="checkbox" name="moreInfo[]" value="qantas">'+'<label for="qantas">Qantas Red E-mail</label>'+"</li>"+"</ul>"+"<hr>"+'<ul class="condition-elements">'+'<li class="check">'+'<input id="conditions" type="checkbox" name="conditions" required>'+'<label for="conditions">I accept the Terms &#38; Conditions</label>'+"</li>"+"</ul>"+'<ul class="button-container">'+'<li class="btn nav submit">'+'<div class="icon"></div>'+"Submit"+"</li>"+'<li class="btn nav skip">'+'<div class="icon"></div>'+"Skip"+"</li>"+"</ul>"+"</form>"+"</div>"+'<div class="footer"></div>'+"</div>"}},listeners:{on:function(t,n){var r=t.children(".main-content").children("form");r.children(".string-elements").find("input").on("blur.disposable",function(){e[n].actions.inputField.onblur(n,$(this))});t.find(".btn.nav").on("mouseenter.disposable",function(){var t=$(this);t.hasClass("prize")&&e.g.navBtn.mouseenter(t);t.hasClass("submit")&&e.g.navBtn.mouseenter(t);t.hasClass("skip")&&e[n].actions.navBtn.skip.mouseenter(t)}).on("mouseleave.disposable",function(){var t=$(this);t.hasClass("prize")&&e.g.navBtn.mouseleave(t);t.hasClass("submit")&&e.g.navBtn.mouseleave(t);t.hasClass("skip")&&e[n].actions.navBtn.skip.mouseleave(t)}).on("click.disposable",function(){var i=$(this);i.hasClass("submit")&&e[n].actions.sendData(n,t,r);i.hasClass("skip")&&e.g.transition.panOut(t)})},off:function(e){var t=e.children(".main-content").children("form");t.children(".string-elements").find("input").off(".disposable");t.find(".btn.nav").off(".disposable")}},actions:{sendData:function(t,n,r){$.post("php/form-data.php",{userData:r.serialize()},function(i){console.dir("returned php error = "+i);i==="none"?e.g.transition.panOut(n):e[t].actions.validate.init(t,r,i)})},validate:{init:function(t,n,r){r=r.split(",");var i=r.length,s;console.log("length = "+i);for(s=0;s<i;s++){console.log("error num "+s+" error = "+r[s]);e[t].actions.validate.change(n,r[s])}},change:function(e,t){var n=e.find($('input[name="'+t+'"]'));n.attr({"data-completed":"false"});n.attr({"data-validate":"false"})}},inputField:{onblur:function(e,t){console.log('running "onblur" actions for inputText...');var n=t.val(),r;n===""?r="false":r="true";t.attr({"data-completed":r})}},navBtn:{skip:{mouseenter:function(t){e.g.navBtn.mouseenter(t);var n=t.children(".icon"),r=t.siblings(".submit").children(".icon"),i=e.s.ani;TweenMax.set(n,{display:"block"});TweenMax.to(n,i,{opacity:"1"});TweenMax.to(r,i,{opacity:"0"})},mouseleave:function(t){e.g.navBtn.mouseleave(t);var n=t.children(".icon"),r=t.siblings(".submit").children(".icon"),i=e.s.ani;TweenMax.to(n,i,{opacity:"0",onComplete:e.g.state,onCompleteParams:[n,"none"]});TweenMax.to(r,i,{opacity:"1"})}}}}},socialMedia:{populate:{init:function(t,n,r){return'<div class="container-shadow" data-ref="'+r+'" data-type="'+n+'">'+'<h2 class="main-heading">Share and get an extra entry into the competition</h2>'+'<div class="main-content">'+'<div class="intro">'+"Click on the social media icons below to get your friends and family involved and find out their traveller profile, plus by sharing you'll get an extra entry into the draw! The message below will be posted into your chosen social streams(s)."+"</div>"+'<a class="btn nav continue" href="'+e.s.badgeSelection.url+'" target="_blank">'+'<div class="icon"></div>'+"Continue"+"</a>"+"</div>"+'<div class="footer">'+'<div class="social-message h3">'+"I just took the Traveller Profile Quiz and am "+e.s.badgeSelection.indefiniteArticle+" "+e.s.badgeSelection.kind+". Take the quiz, discover your travel personality and be in to win a $10,000 holiday!"+"</div>"+'<ul class="social-buttons">'+'<li class="btn" data-type="facebook">'+'<div class="icon"></div>'+'<img src="img/profile-badge-0.png">'+"</li><!--"+'--><li class="btn" data-type="twitter">'+'<div class="icon"></div>'+'<img src="img/profile-badge-1.png">'+"</li><!--"+'--><li class="btn" data-type="google">'+'<div class="icon"></div>'+'<img src="img/profile-badge-2.png">'+"</li><!---->"+"</ul>"+"</div>"+"</div>"}},listeners:{on:function(t,n){t.find(".continue").on("mouseenter.disposable",function(){e.g.navBtn.mouseenter($(this))}).on("mouseleave.disposable",function(){e.g.navBtn.mouseleave($(this))});t.children(".footer").children(".social-buttons").on("mouseenter.disposable","li",function(){e[n].actions.social.mouseenter($(this))}).on("mouseleave.disposable","li",function(){e[n].actions.social.mouseleave($(this))}).on("click.disposable","li",function(){e[n].actions.social.onclick($(this))})},off:function(e){e.find(".continue").off(".disposable");e.children("footer").children("social-buttons").off(".disposable")}},actions:{social:{mouseenter:function(t){console.log("social enter...");var n=t.children(".icon"),r=t.siblings().not(t),i=e.s.ani;t.attr({"data-state":"over"});TweenMax.set(t,{opacity:"1"});TweenMax.set(n,{display:"block"});TweenMax.to(n,i,{opacity:"1"});TweenMax.to(n,i*3,{left:"-70px",top:"-70px",yoyo:!0,repeat:-1});TweenMax.to(r,i,{opacity:"0.5"})},mouseleave:function(t){console.log("social leave...");var n=t.children(".icon"),r=t.siblings(),i=e.s.ani;t.attr({"data-state":"up"});TweenMax.to(n,i,{left:"-90px",opacity:"0",top:"-90px",onComplete:e.g.state,onCompleteParams:[n,"none"]});TweenMax.to(r,i,{opacity:"1"})},onclick:function(e,t){console.log("---> pull up selected social prompt and add click to the user database")}}}}};(function(){e.g.getJson()})()});